version: '2.4'

networks:
  default:
    external:
      name: net-nginx-proxy

services:
  dm:
    container_name: dm_app
    restart: on-failure
    image: $IMAGE_NAME_BACKEND
    environment:
      - TZ=Europe/Moscow

  database:
    container_name: dm_db
    image: postgres:14.5-alpine3.16
    restart: always
    volumes:
      - /home/dev/docker/dm/DB_postrges:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: "postgres"
      POSTGRES_PASSWORD: "avanger1"
      POSTGRES_DB: "dm"

  pwa-react:
    container_name:  dm_pwa-react
    image: $IMAGE_NAME_FRONTEND
    restart: always
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.dm-dev.rule=Host(`dm-dev.briogroup.ru`)"
      - "traefik.http.services.dm-dev-service.loadbalancer.server.port=3000"

